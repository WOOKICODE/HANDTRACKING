(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))d(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&d(l)}).observe(document,{childList:!0,subtree:!0});function s(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function d(e){if(e.ep)return;e.ep=!0;const i=s(e);fetch(e.href,i)}})();const r=document.getElementById("input_video"),c=document.getElementById("overlay"),h=c.getContext("2d"),u=new window.FaceMesh({locateFile:t=>`https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh/${t}`});u.setOptions({maxNumFaces:1,refineLandmarks:!0,minDetectionConfidence:.6,minTrackingConfidence:.5});let a=[];function f(t,o,s){return t+(o-t)*s}u.onResults(t=>{if(h.clearRect(0,0,c.width,c.height),!t.multiFaceLandmarks||t.multiFaceLandmarks.length===0)return;const o=r.clientWidth,s=r.clientHeight;c.width=o,c.height=s;const d=performance.now()*.002,e=Math.floor(128+127*Math.sin(d)),i=Math.floor(128+127*Math.sin(d+2)),l=Math.floor(128+127*Math.sin(d+4)),g=`rgb(${e},${i},${l})`,m=t.multiFaceLandmarks[0];a.length===0&&(a=m.map(n=>({x:n.x,y:n.y})));for(let n=0;n<m.length;n++)a[n].x=f(a[n].x,m[n].x,.2),a[n].y=f(a[n].y,m[n].y,.2),h.beginPath(),h.arc((1-a[n].x)*o,a[n].y*s,5,0,2*Math.PI),h.fillStyle=g,h.fill()});async function p(){try{const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}});r.srcObject=t,await r.play(),c.width=r.clientWidth,c.height=r.clientHeight,new window.Camera(r,{onFrame:async()=>{r.readyState>=2&&await u.send({image:r})},width:r.videoWidth,height:r.videoHeight,facingMode:"user"}).start()}catch(t){console.error("Błąd uruchamiania kamery:",t),alert("Nie udało się uruchomić kamery. Sprawdź uprawnienia i HTTPS.")}}p();
